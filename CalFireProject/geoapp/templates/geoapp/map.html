{% extends "geoapp/base.html" %}
{% load static %}

{% block title %}Wildfire Map{% endblock %}

{% block extra_head %}
<style>
  #map { height: 100vh; width: 100%; }

  /* Sidebar Styling */
  #sidebar {
    width: 280px; 
    background: #f9f9f9;
    padding: 10px;
    border-left: 1px solid #ccc;
    font-family: sans-serif;
  }

  .select {
    width: 100%;
    padding: 5px;
  }

  
.legend-marker,
.legend-perimeter {
  display: inline-block;
  vertical-align: middle;
  margin-right: 6px;
}

.legend-marker {
  width: 16px;
  height: 16px;
  background-color: #f6b317;
  border-radius: 50%;
  box-shadow: 0 0 0 8px rgba(246, 179, 23, 0.3); /* transparenter Kreis dahinter */
}

.legend-perimeter {
  width: 18px;
  height: 18px;
  background-color: rgba(255, 0, 0, 0.2); /* transparente FÃ¼llung */
  border: 2px solid red; /* rote Umrandung */
}
</style>

<!-- Turf for Spatial Analysis -->
<script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

{% endblock %}

{% block content %}
  <h1 class="mb-4">Wildfires 2024 in California</h1>

  <div class="d-flex vh-100">
    <!-- map -->
    <div id="map" class="flex-grow-1"></div>

    <!-- Sidebar mit Card -->
    <div id="sidebar" class="p-3 bg-light border-start">
      
      <div class="card shadow-sm mb-3">
        <div class="card-header bg-danger text-white">
          <i class="bi bi-filter"></i> Filter Fires by Cause
        </div>
        <div class="card-body">
          <select id="causeFilter" class="form-select mb-3">
            <option value="all">All Causes</option>
          </select>
          <small class="text-muted">
            Select a cause to highlight related wildfire perimeters on the map.
          </small>
        </div>
      </div>


      <!-- Legend Card -->
      <div class="card shadow-sm mt-3">
      <div class="card-header bg-secondary text-white">
        <i class="bi bi-map"></i> Legend
      </div>
      <div class="card-body">
        <p class="mb-2">
          <span class="legend-marker"></span> Aggregated Damaged Buildings
        </p>
        <p class="mb-0">
          <span class="legend-perimeter"></span> Wildfire Perimeters
        </p>
      </div>
      </div>

       <!-- Info Card -->
      <div class="card shadow-sm mt-3">
        <div class="card-header bg-primary text-white">
          <i class="bi bi-info-circle"></i> About This Application
        </div>
        <div class="card-body">
          <p  class="mb-2">
            This interactive map displays wildfire perimeters buildings damaged by wildfires.
            Use the filter above to highlight fires by their reported cause.
            Zoom in or click on the aggregated points to see single buildings.
          </p>
          <p class="mb-0">
            Click anywhere on the map to see fires within a specified radius of that location.
          </p>
        </div>
      </div>

    </div>
  </div>
{% endblock %}


{% block extra_js %}  
  <!-- Leaflet MarkerCluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="{% static 'geoapp/js/map.js' %}"></script> 
{% endblock %} 



